# System Change Proposals

**Status:** Design Phase v0.1  
**Purpose:** Enable SI to identify, propose, and track system improvements based on patterns observed during turn execution.

---

## Quick Overview

SI operates within a defined system (action types, tools, capabilities, etc.). As SI executes, it may encounter situations where the system needs to evolve. The **System Change Proposals** system enables SI to:

1. **Flag** changes needed during turn execution
2. **Analyze** flagged changes to identify patterns
3. **Propose** system improvements with rich evidence
4. **Surface** proposals for human review and decision-making

---

## Architecture

### Three Key Components

**1. Change Flagging Daemon** (`change-flagging-daemon.md`)
- Runs during turn execution
- Monitors daemons (especially FC) for suggestions of missing capabilities
- Creates flags in turn trace when changes are needed
- Initially: Captures FC suggestions for new action types, other daemon suggestions for missing tools/capabilities
- Future: May run LLM analysis on traces to generate proactive suggestions

**2. System Analyzer Daemon** (`system-analyzer-daemon.md`)
- Runs separately from turn execution (can query historic turns)
- Reads flagged changes from turn traces
- Deduplicates: checks if proposal already exists for this change or similar changes
- Generates rich proposals with evidence, rationale, and decision-support information
- Stores proposals for human review

**3. Human Review & Implementation**
- Human reviews proposals
- Decides whether to approve and how to document the change
- Generates code based on approved documentation
- (Code generation is out of scope for this system)

---

## Data Structures

### Change Needed Flag (`change-needed-flag.md`)
Placed in turn trace when SI detects a change is needed:
```
{
  flag_id: string,
  flag_type: "new_action_type" | "new_tool" | "tool_enhancement" | "capability_gap",
  severity: "info" | "warning" | "critical",
  source_daemon: string,
  details: { ... },
  context: { turn_id, user_id, action_attempted, rationale, ... }
}
```

### Proposal (`proposal-structure.md`)
Generated by System Analyzer for human review:
```
{
  proposal_id: string,
  proposal_type: string,
  title: string,
  description: string,
  rationale: string,
  evidence: {
    total_flags: number,
    severity_distribution: { info, warning, critical },
    source_daemons: string[],
    affected_turns: string[],
    use_cases: string[]
  },
  details: { ... },
  suggested_documentation: { ... },
  status: "pending" | "approved" | "rejected" | "implemented"
}
```

---

## Data Flow

```
Turn Execution
    ↓
Change Flagging Daemon detects missing capability
    ↓
Flag stored in Turn Trace
    ↓
System Analyzer Daemon (runs separately)
    ↓
Reads flagged changes from historic turns
    ↓
Deduplicates against existing proposals
    ↓
Generates rich proposal with evidence
    ↓
Proposal stored for human review
    ↓
Human reviews, decides, writes documentation
    ↓
Code generated from documentation
```

---

## What Gets Proposed?

### Initially (v1)
- New action types (FC suggesting types that don't exist)
- New tools (daemons suggesting tools that would help)
- Tool enhancements (suggestions to improve existing tools)

### Future (as we learn what makes sense)
- Consciousness mandate changes
- Memory policy changes
- Daemon architecture changes
- Other system improvements

---

## Key Design Principles

1. **Documentation-First**: Proposals include suggested documentation structure that humans can refine
2. **Evidence-Based**: Proposals include evidence (which turns flagged this, how many times, severity)
3. **Deduplication**: System Analyzer checks for existing proposals to avoid redundant work
4. **Extensible**: Initially simple (FC action type suggestions), can expand to other proposal types
5. **Auditable**: All proposals tracked with creation date, evidence, and rationale
6. **Technology-Agnostic**: Storage mechanism (DB/files/etc) is a separate decision

---

## Documentation Files

- **`overview.md`** - High-level overview and architecture
- **`change-needed-flag.md`** - Structure of flags in turn traces
- **`proposal-structure.md`** - Structure of proposals for human review
- **`change-flagging-daemon.md`** - Daemon that creates flags during turn execution
- **`system-analyzer-daemon.md`** - Daemon that generates proposals from flags
- **`test-conditions.md`** - Test conditions for both daemons (TBD)

---

## Next Steps

1. Define test conditions for Change Flagging Daemon
2. Define test conditions for System Analyzer Daemon
3. Create integration documentation (how this connects to turn execution, FC, etc.)
4. Implement Change Flagging Daemon
5. Implement System Analyzer Daemon
6. Set up proposal storage and retrieval
7. Create human review interface/process

---

## Related Documentation

- `documentation/frontal-cortex/README.md` - FC action type registry and proposals
- `documentation/daemon-interface.md` - Daemon interface that both daemons implement
- `documentation/turn-trace/overview.md` - Turn trace structure where flags are stored
- `documentation/turn.md` - Turn execution where flags are created

